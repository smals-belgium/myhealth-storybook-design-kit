import { Meta, Canvas } from '@storybook/blocks';
import * as ProgressStories from './../../design-kit/progress-indicators/progress-indicators.stories';


<Meta title="Components/Progress Indicators" />

# Progress Indicators
> Use a dynamic progress indicator for every action that might take longer than 1 second.
> Mobile users are often impatient and pressured by many variables in their environment. In the absence of a progress indicator, people will think that the site or app is broken and might quit the task.

## Progress spinner
> The progress spinner component is based of Angular Material's [progress spinner](https://material.angular.io/components/progress-spinner). Material's core features will remain the same and can be implemented in the same way.
> The My Health belgium.be Design Kit will simply overrule the component's styling.

<Canvas of={ProgressStories.Spinner} sourceState="none" />

### Usage

To use the **progress spinner component** My Health styles, include them in your root SCSS file:

```css
@use '@myhealth-belgium/design-kit' as mh;

@include mh.override-all-mat-components();
```

### Usage guidelines
Whenever the action will take less than 3 seconds, use a progress spinning.

## Progress bar
> The progress bar component is based of Angular Material's [progress bar](https://material.angular.io/components/progress-bar). Material's core features will remain the same and can be implemented in the same way.
> The My Health belgium.be Design Kit will simply overrule the component's styling.

<Canvas of={ProgressStories.Bar} sourceState="none" />

### Usage

To use the **progress bar component** My Health styles, include them in your root SCSS file:

```css
@use '@myhealth-belgium/design-kit' as mh;

@include mh.override-mat-progress-bar();
```

Alternatively, you can use **all component** My Health styles by including them in your root SCSS file:

```css
@use '@myhealth-belgium/design-kit' as mh;

@include mh.override-all-mat-components();
```

### Usage guidelines
Whenever the action might take more than 3 seconds, use a progress bar instead of a spinning gear.
Unlike spinning gears progress bars also give a sense of the progress made and of how much more work needs to be done.
Their downside is that they demand more user attention and are more disruptive, so thatâ€™s why they are generally not needed for quick actions that take around less than 3 seconds.

## Skeletons
> Skeleton loaders are, in simplest terms, a static / animated placeholder for the information that is still loading. It mimic the structure and look of the entire view.
> It gives an idea regarding what kind of content is loading in each block like image, text, long text etc.

<Canvas of={ProgressStories.Skeleton} sourceState="none" />

### Usage
My Health uses the [ngx-skeleton-loader](https://www.npmjs.com/package/ngx-skeleton-loader) package for its skeleton loaders.
Documentation on how to use this skeleton loader can be found here as well.

### Usage guidelines
Show a skeleton screen first for pages that will take longer to load.
Skeleton screens show users the main components of a page with no content yet loaded.
Skeleton screens are helpful because users get to do something while waiting for the page load.

#### Table

In a [table](/docs/components-table--docs), we use the skeleton loader whenever data is being loaded, and the component thus comes into a **loading state**.

To make sure there are **no jumps** in our page when switching between states, we calculate the `count` of skeleton loader lines that should be shown,
as well as change the `height` of the lines to whatever fits for your table.

When `isLoading` is set to `true`, we want to make sure all data rows are hidden and the skeleton loader is visible.

In this example, `dataSource` is our Material DataSource variable, and `pageSize` is the maximum page size of our MatPaginator.

```ts
dataSource: MatTableDataSource<any> = new MatTableDataSource<any>([]);
pageSize: number = 10;
isLoading: boolean = false;
```

```html
  ...
  <!-- Data row -->
  <tr [hidden]="isLoading" mat-row *matRowDef="let row; columns: columns"></tr>
</table>

@if (isLoading) {
  <ngx-skeleton-loader
    [count]="dataSource.data.length <= 0 ? 3 : dataSource.data.length > pageSize ? pageSize : dataSource.data.length"
    appearance="line"
    [theme]="{
      height: '47px',
      margin: '0'
    }"
  />
}
```
